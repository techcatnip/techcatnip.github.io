<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Linux常用配置项 | 馒头馅儿大肉包</title><meta name="keywords" content="常用配置项,配置IP地址,yum,apt,防火墙,selinux,systemd"><meta name="author" content="馒头馅儿大肉包"><meta name="copyright" content="馒头馅儿大肉包"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Linux常用配置项"><meta name="application-name" content="Linux常用配置项"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Linux常用配置项"><meta property="og:url" content="http://blog.techcat.cc/posts/217c81a9.html"><meta property="og:site_name" content="馒头馅儿大肉包"><meta property="og:description" content="修改主机名123# 注意：主机名不要使用下划线，但支持横线、数字. 数字中间也不要使用小数点,会导致一些服务起不来hostname ubuntu18-04   # 临时设置主机名hostnamectl set-hostname ubuntu18-04  # 永久设置主机名  创建账号和修改密码Cen"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://s3.bmp.ovh/imgs/2023/08/27/6d630e8342072ee5.jpg?_r_=9f688367-b81a-07ea-2d65-df4159f5e4f1"><meta property="article:author" content="馒头馅儿大肉包"><meta property="article:tag" content="馒头馅儿大肉包,王大脑袋,Linux,kubernetes"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://s3.bmp.ovh/imgs/2023/08/27/6d630e8342072ee5.jpg?_r_=9f688367-b81a-07ea-2d65-df4159f5e4f1"><meta name="description" content="修改主机名123# 注意：主机名不要使用下划线，但支持横线、数字. 数字中间也不要使用小数点,会导致一些服务起不来hostname ubuntu18-04   # 临时设置主机名hostnamectl set-hostname ubuntu18-04  # 永久设置主机名  创建账号和修改密码Cen"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://blog.techcat.cc/posts/217c81a9"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://leafy-dasik-1bfebc.netlify.app/.netlify/functions/twikoo',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":"https://friends.techcat.cc"},
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"本文章距离最后一次更新已经过去了","messageNext":"天，文章内容可能已经变得不可靠或者版本不适配，请谨慎阅读。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 馒头馅儿大肉包","link":"链接: ","source":"来源: 馒头馅儿大肉包","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: {"enable":true,"delay":100,"shiftDelay":200},
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '馒头馅儿大肉包',
  title: 'Linux常用配置项',
  postAI: '',
  pageFillDescription: '修改主机名, 创建账号和修改密码, 创建账号x2F修改密码, 配置开机默认用户, 配置静态IP地址, Centos 7配置静态IP地址, ubuntu配置静态IP地址, Centos 8配置静态IP地址, nmcli常用命令一览, yum、apt的基本使用, yumx2Fdnf常用命令, apt常用命令, 安装常用软件包, rpm、dpkg包的基本查询和使用, rpm常用命令, dpkg常用命令, 配置sshd root远程登陆, 修改网卡名称为eth0, 查看和关闭防火墙, 查看和关闭Selinux, 查看和关闭swap分区, 配置系统服务systemd, centos6, centos7x2F8、ubuntu, systemd unit配置文件, 日志管理工具 journalctl, 生成随机字符, 时间同步, 搭建chrony时间同步服务器(局域网同步时间）, 设置时间和时区, 优化内核参数, LVM磁盘分区修改主机名注意主机名不要使用下划线但支持横线数字数字中间也不要使用小数点会导致一些服务起不来临时设置主机名永久设置主机名创建账号和修改密码批量添加用户和修改密码批量修改服务器用户密码烟雨醉梦里的博客博客如何在下创建新用户名和密码创建用户技术探索者的博客博客修改用户名和密码修改用户名古人诚不我欺的博客博客忘记密码重置用户密码简书创建账号修改密码修改账号密码密码账号名配置开机默认用户配置文件路径在下写入用户名重启系统后即可自动进入你指定的账户了配置静态地址配置静态地址编辑网卡配置文件静态地址子网掩码地址网关地址开启自动启动重启网络配置静态地址和的网卡配置文件名是版本变为编辑网卡配置文件网卡名静态地址取消的网关地址地址多个用逗号分隔中间不要有空格重启网络配置静态地址已经被弃用需要使用参数配置网关重启网络配置静态地址在之后使用命令重启网络时会出现以下报错意思为无法重启网络服务原因是无法找到网络服务在含上在里也看不到任何脚本文件中此路径下包含网卡配置文件和一些脚本没有传统的因此只能通过命令工具集进行网络配置换言之在上必须开启否则无法使用网络编辑网卡配置文件重载重载网卡启用相当于常用命令一览配置静态浅雨凉博客园查看类似于创建配置静态等同于配置其中并启动创建配置动态等同于配置其中并启动修改非交互式启用相当于停止相当于删除类似于并删除查看列表查看详细信息重载所有或到不会立即生效立即生效有种方法查看详细信息查看所有详细信息查看指定的详细信息查看纳管状态开启纳管关闭纳管谨慎执行的基本使用常用命令即是新一代的软件包管理器发行日期是年月日包管理器采用编写发行许可为首先出现在发行版中在版本正式取代了包管理器克服了包管理器的一些瓶颈提升了包括用户体验内存占用依赖分析运行速度等客户端配置文件为所有仓库提供公共配置为每个仓库的提供配置文件常用命令安装指定软件包并确认安装更新系统中所有软件包升级指定的软件包列出可用的镜像源列出所有可用的和组会有大量输出清除所有缓冲数据缓存本地源查看提供某个命令的包列出一个包所有依赖的包删除指定软件包软件包仅下载不安装如果下载的包有依赖也会一起下载如果提示没有选项则需要安装软件包只有需要搜索可用的软件包显示已安装的软件包的信息查看已经安装的包查看可安装的包查看可以升级的包检查更新仓库管理显示所有资源库显示所有已启动的资源库显示所有被禁用的资源库禁用仓库启用仓库常用命令相当于和中最常用命令选项的集合具有更精减但足够的命令选项而且参数选项的组织方式更为有效此外启用的几个特性也非常有帮助例如可以在使用命令安装或删除程序时看到进度条还会在更新存储库数据库时提示用户可升级的软件包个数与有一些类似的命令选项但它并不能完全向下兼容命令也即可用替换部分系列命令但不是全部包索引配置文件常用命令列出包含条件的包已安装可升级等等于列出已安装的软件包编辑源件搜索安装包或者更详细查看仓库中软件包的详细信息查看仓库中软件包有哪些版本可以安装或者在线安装软件包安装软件包的时候指定安装具体的版本配合使用卸载单个软件包但是保留配置件卸载单个软件包以及删除配置件删除安装包并解决依赖关系更新本地软件包列表索引修改了仓库后必须执升级所有已安装且可升级到新版本的软件包或者在线升级整个系统软件包自动处理依赖关系必要时可以移除旧软件包查看文件来自于哪个包类似中的默认是包含此字符串的文件正则表达式查询软件依赖哪些包查询软件被哪些包依赖安装常用软件包命令命令网络工具最小化安装建议的软件包包的基本查询和使用常用命令包默认安装路径通常情况下包采用系统默认的安装路径所有安装文件会按照类别分散安装到目录中默认安装路径含义配置文件安装目录可执行的命令安装目录程序所使用的函数库保存位置基本的软件使用手册保存位置帮助文件保存位置常用命令包全名包的升级安装后跟详细路径显示进度显示过程强行安装包全名卸载查询安装的包后跟明确的包名以为例列出所有安装的包并统计数量利用进行模糊搜索如搜索包查看包的信息安装日期等列出包中所有文件列表列出包的配置文件列出包中的脚本文件查看某个文件来自哪个包如常用命令注意一般建议不要使用卸载软件包因为删除包时其它依赖它的包不会卸载并且可能无法再正常运行安装包删除包不建议不自动卸载依赖于它的包删除包包括配置文件列出当前已安装的包类似查看软件包信息列出该包的状态包括详细信息类似列出该包中所包含的文件类似搜索包含的包类似配置包使用配置所有没有配置的软件包列出包的内容件及录内容类似解开包的内容配置远程登陆默认情况下不允许远程如果有实际场景需要允许远程则需要设置密码并且编辑件注意不是文件修改如下默认为禁登录改为允许登录打开密码认证其实默认就是允许通过密码认证登录切换到户环境设置密码重启服务并测试户远程连接使用命令修改配置文件重启服务修改网卡名称为编辑配置文件在前面添加参数前后使用空格分隔重新生成配置并更新内核参数重新生成配置并更新内核参数或者都可以使用下面的命令更新配置重启修改网卡配置文件复制网卡配置文件名称可能会不同编辑网卡配置文件修改网卡名称修改为新的修改为新的重启网络修改网卡配置文件名称可能不同使用补全即可修改网卡名静态地址取消的网关地址地址多个用逗号分隔重启网络查看和关闭防火墙查看和关闭中默认没有安装有一个类似于的强制访问控制系统名为查看状态停止禁止查看状态或者查看配置文件共有个状态执行中不执行但产生警告关闭临时关闭设置为模式设置为模式永久关闭需要编辑配置文件查看和关闭分区临时关闭永久关闭需要编辑配置文件将分区注释掉并重启生效注释掉分区配置系统服务是的全小写即使在句子开头也是小写是初始化程序和初始化脚本的现代替代者像一样是所有进程之母它负责使主机启动到可以做生产性任务的状态设定的一些功能比老的初始化程序要广泛得多它要管理正在运行的主机的许多方面包括挂载文件系统管理硬件处理定时器以及启动和管理生产性主机所需的系统服务服务启动服务服务停止服务服务重启服务服务查看服务状态服务设置服务在各等级为开机启动各等级包括等级服务设置服务禁止开机启动添加添加一个管理的并在目录下添加相应的符号链接删除从管理名单中删除该并且删除目录下所有与之关联的符号链接列出的启动信息如果不指定会列出所有的信息设置运行级别设置在运行级别为的情况下都是开启的状态指定运行级为等级表示表示关机等级表示单用户模式等级表示无网络连接的多用户命令行模式等级表示有网络连接的多用户命令行模式等级表示不可用等级表示带图形界面的多用户模式等级表示重新启动可能是史上最全面易懂的服务管理教程强烈建议收藏腾讯云开发者社区腾讯云常用命令配置文件系统或用户自定义的配置文件文件指向该目录软件运行时生成的配置文件系统或第三方软件安装时添加的配置文件文件指向该目录重新加载服务每次修改了的配置文件后需要执行以下命令重新加载的配置文件设置开机自动启动查看服务状态启动立即启动并设置为开机启动取消开机启动查看是否开机启动查看配置文件的内容显示远程主机的某个的状态列出所有正在运行的服务即所有已加载和正在运行的服务或者列出所有已加载但处于活动状态的服务包括正在运行的服务和已退出的服务可以添加选项其值为或者启动管理查看当前系统的所有获取当前正在使用的运行查看一个包含的所有查看启动时的默认运行级别设置启动时的默认运行级别为进入图形化界面需要重启才能看到效果设置启动时的默认运行级别为不进入图形界面的多用户模式需要重启才能看到效果在不重启的情况下切换到运行级别下在不重启的情况下切换到图形界面下用于检查和控制各种系统服务和资源的状态重启系统关闭系统切断电源进入睡眠模式暂停系统系统进入休眠状态让系统进入交互式休眠状态强制进入救援状态单用户状态强制进入紧急救援模式显示此次系统启动时运行每个服务所消耗的时间可以用于分析系统启动过程中的性能瓶颈查看启动耗时查看每个服务的启动耗时显示瀑布状的启动过程流显示指定服务的启动流查看和修改系统的主机名和主机信息显示当前主机的信息设置主机名用于查看和管理系统的时间和时区信息查看当前时区设置显示所有可用的时区设置当前时区设置时区为美国纽约设置时区为中国上海设置年月日设置时间小时分钟秒用于管理系统已登录用户和的信息列出当前列出当前登录用户列出显示指定用户的信息辅助性工具用星号屏蔽用户的任意输入然后返回实际输入的内容显示主机的虚拟化类型用于将任意指定的命令包装成一个临时的后台服务运行中文手册金步国可以将一个指定的操作变成后台运行的服务它的效果似乎与直接在命令后加上表示后台运行的符号很相似然而它让命令成为服务还意味着它的生命周期将由控制具体来说包括以下好处服务的生命击期由接管不会随着启动它的控制台关闭而结束可以通过工具管理服务的状态可以通过工具查看和管理服务的日志信息可以通过提供的方法限制服务的内存磁盘等系统资源的使用情况配置文件中文手册部分中文手册部分如何杀死进程中文手册进程环境变量中文手册常见文件示例注意每个单元之间必须有空行分开运行的用户运行的组数据默认保存时间为天启动时加上此参数可以控制数据保存时间文件说明当前的描述文档地址表示本应该在某服务之后启动只涉及启动顺序不涉及依赖关系服务的依赖关系表示本与其它之间存在强依赖关系如果本被激活此处列出的也会被激活如果其中一个依赖的无法激活都不会启动本如果依赖的启动失败不影响本的继续运行当指定的停止时也会导致本停止当指定的停止或重启时也会导致本停止或重启设置进程的启动类型必须设为之一默认值进程就是该服务的主进程并且会认为在创建了该服务的主服务进程之后该服务就已经启动完成该服务将会在启动完成之后通过之类的接口发送一个通知消息将会在启动后继单元之前首先确保该进程已经成功的发送了这个消息该服务只有获得了指定的名称之后才会认为该服务启动完成才会开始启动后继单元设为此类型相当于隐含的依赖于单元进程将会在启动过程中使用系统调用也就是当所有通信渠道都已建好启动亦已成功之后父进程将会退出而子进程将作为主服务进程继续运行这是传统守护进程的经典做法在这种情况下会认为在父进程退出之后该服务就已经启动完成如果使用了此种类型那么建议同时设置选项以帮助准确可靠的定位该服务的主进程将会在父进程退出之后立即开始启动后继单元与类似不同之处在于服务进程将会被延迟到所有活动任务都完成之后再执行只有在该服务的主服务进程执行完成之后才会认为该服务启动完成其他后继单元必须一直阻塞到这个时间点之后才能继续启动建议对长时间持续运行的服务尽可能使用这是最简单和速度最快的选择注意类型的服务无法报告启动失败也无法在服务完成初始化后对其他单元进行排序当当客户端需要通过仅由该服务本身创建的通道而非由创建的套接字或之类连接到该服务的时候或该服务必须提供接口才是最佳选择这两种类型都允许服务进程精确的安排何时算是服务启动成功何时可以继续启动后继单元类型需要服务进程明确使用函数或类似的否则可以使用作为替代它支持传统的服务启动协议服务启动时执行的命令和参数重启服务时执行的命令等待服务停止启动的时间以秒为单位重新启动服务前的睡眠时间以秒为单位配置当服务的进程退出被杀死或达到超时时是否重新启动服务服务将不会重新启动这是默认设置仅在服务进程异常退出时重启所谓异常退出是指退出码不为如果进程因信号或超时而终止时重新启动总是重新启动该服务文件的路径一般位于目录下强烈建议在的情况下明确设置此选项如果设为相对路径那么表示相对于目录将会在此服务启动完成之后从此文件中读取主服务进程的设置进程的工作目录设置进程在执行时使用的用户与组既可以设为一个数字形式的也可以设为一个字符串形式的名称设置与此服务通信所使用的名称在的情况下必须明确设置此选项服务启动之前执行的命令服务启动之后执行的命令服务停止时执行的命令和参数服务停止之后执行的命令定义如何停止服务默认值当前控制组里面的所有子进程都会被杀掉只杀主进程主进程将收到信号子进程收到信号没有进程会被杀掉只是执行动作而不杀死任何进程这会导致即使单元已经停止但是该单元的依然一直存在直到其中的进程全部死亡当前可用于启动的别名此处列出的名称必须与服务文件名具有相同的后缀即类型在执行时将创建从这些名称到文件名的符号链接表示该服务所在的它的值是一个或多个当时符号链接会放入目录下面以名后缀构成的子目录中表示该服务所在的它的值是一个或多个当前时符号链接会放入目录下面以名后缀构成的子目录中当或时会同时和的其它列表的含义是服务组表示一组服务指的是所在的是多用户模式这个设置非常重要因为执行是会将链接到目录之中实现开机启动的功能进程环境变量可执行文件的目录列表冒号分隔的绝对路径此值固定为本地化设置可以通过文件设置用户名用户名家目录登录单元主进程的如果能确定的话日志管理工具中文手册金步国概述是及以上专有的日志管理工具该工具是从这个文件里读取信息统一管理所有的启动日志带来的好处就是可以只用一个命令查看所有日志内核日志和应用日志日志的配置文件是使用方法查看所有日志默认情况下只保存本次启动的日志查看内核日志不显示应用日志查看系统本次启动的日志查看上一次启动的日志如上次系统崩溃需要查看日志时就要看上一次的启动日志需更改设置修改配置文件将服务配置为在重新启动后永久保留系统日志只需要将参数设置为提交更改后重新启动服务以使配置更改生效修改此处重启服务查看上一次启动的日志查看指定时间的日志查看昨天的日志查看月日到月日的日志查看从点到现在的日志显示尾部的最新行日志显示尾部指定行数的日志查看的是的日志但是格式上有所调整如主机名格式不一样而已实时滚动显示最新日志查看服务的日志查看进程的日志显示所有进程产生的日志查看某个路径的脚本的日志查看指定用户的日志查看某个的日志实时滚动显示某个的最新日志合并显示多个的日志查看指定优先级及其以上级别的日志日志优先级共有级以格式单行输出以格式多行输出可读性更好建议选择多行输出显示日志占据的硬盘空间指定日志文件占据的最大空间指定日志文件保存多久生成随机字符生成随机码随机数字提取位的随机数字和字母生成后缀为的随机数字时间同步搭建时间同步服务器局域网同步时间服务端客户端使用客户端进行验证参数解释指定使用作为时间服务器池选项表示在初始同步时会发送多个请求以加快同步速度指定用于保存时钟漂移信息的文件路径设置当系统时间与服务器时间偏差大于秒时会以秒的步长进行调整如果偏差超过秒则立即进行时间调整启用硬件时钟同步功能可以提高时钟的准确性允许网段范围内的主机与进行时间同步将本地时钟设为值表示时钟的准确度值越小表示准确度越高指定使用的密钥文件路径用于对时间同步进行身份验证指定时区为指定日志文件存放目录设置时间和时区设置时间设置时区查看当前时区设置显示所有可用的时区设置当前时区设置时区为美国纽约设置时区为中国上海设置年月日设置时间小时分钟秒查看所有亚洲时区修改时区更新硬件时钟查看时区设置优化内核参数磁盘分区',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-19 18:27:03',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.0.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.techcat.cc/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://index.anheyu.com/" title="个人主页"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/13/64d8c2748ef34.jpg" alt="个人主页"/><span class="back-menu-item-text">个人主页</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">馒头馅儿大肉包</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=6681991756&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">音乐</div><span class="author-content-item-title">灵魂的碰撞💥</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div><div class="console-btn-item" id="consoleKeyboard" onclick="anzhiyu.keyboardToggle()" title="快捷键开关"><a class="keyboard-switch"><i class="anzhiyufont anzhiyu-icon-keyboard"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/" itemprop="url">Linux</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E9%A1%B9/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>常用配置项</span></a><a class="article-meta__tags" href="/tags/%E9%85%8D%E7%BD%AEIP%E5%9C%B0%E5%9D%80/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>配置IP地址</span></a><a class="article-meta__tags" href="/tags/yum/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>yum</span></a><a class="article-meta__tags" href="/tags/apt/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>apt</span></a><a class="article-meta__tags" href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>防火墙</span></a><a class="article-meta__tags" href="/tags/selinux/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>selinux</span></a><a class="article-meta__tags" href="/tags/systemd/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>systemd</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Linux常用配置项</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-01-19T10:14:54.000Z" title="发表于 2024-01-19 18:14:54">2024-01-19</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-01-19T10:27:03.285Z" title="更新于 2024-01-19 18:27:03">2024-01-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">8.4k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>31分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="Linux常用配置项"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://s3.bmp.ovh/imgs/2023/08/27/6d630e8342072ee5.jpg?_r_=9f688367-b81a-07ea-2d65-df4159f5e4f1"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://blog.techcat.cc/posts/217c81a9.html"><header><a class="post-meta-categories" href="/categories/Linux/" itemprop="url">Linux</a><a href="/tags/%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E9%A1%B9/" tabindex="-1" itemprop="url">常用配置项</a><a href="/tags/%E9%85%8D%E7%BD%AEIP%E5%9C%B0%E5%9D%80/" tabindex="-1" itemprop="url">配置IP地址</a><a href="/tags/yum/" tabindex="-1" itemprop="url">yum</a><a href="/tags/apt/" tabindex="-1" itemprop="url">apt</a><a href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/" tabindex="-1" itemprop="url">防火墙</a><a href="/tags/selinux/" tabindex="-1" itemprop="url">selinux</a><a href="/tags/systemd/" tabindex="-1" itemprop="url">systemd</a><h1 id="CrawlerTitle" itemprop="name headline">Linux常用配置项</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">馒头馅儿大肉包</span><time itemprop="dateCreated datePublished" datetime="2024-01-19T10:14:54.000Z" title="发表于 2024-01-19 18:14:54">2024-01-19</time><time itemprop="dateCreated datePublished" datetime="2024-01-19T10:27:03.285Z" title="更新于 2024-01-19 18:27:03">2024-01-19</time></header><h2 id="修改主机名"><a href="#修改主机名" class="headerlink" title="修改主机名"></a>修改主机名</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意：主机名不要使用下划线，但支持横线、数字. 数字中间也不要使用小数点,会导致一些服务起不来</span></span><br><span class="line">hostname ubuntu18-04   <span class="comment"># 临时设置主机名</span></span><br><span class="line">hostnamectl set-hostname ubuntu18-04  <span class="comment"># 永久设置主机名</span></span><br></pre></td></tr></table></figure>

<h2 id="创建账号和修改密码"><a href="#创建账号和修改密码" class="headerlink" title="创建账号和修改密码"></a>创建账号和修改密码</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_27754983/article/details/73693060">CentOS批量添加用户和修改密码_批量修改centos6服务器用户密码_烟雨醉梦里的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hhd1988/article/details/127275470">Linux：如何在centos下创建新用户名和密码_centos创建用户_技术探索者的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/gahsfjshf/article/details/121115663">centos 7修改用户名和密码_centos7修改用户名_古人诚不我欺的博客-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/581c0444d627">Centos 7 忘记密码重置用户密码 - 简书 (jianshu.com)</a></p>
<h3 id="创建账号-修改密码"><a href="#创建账号-修改密码" class="headerlink" title="创建账号&#x2F;修改密码"></a>创建账号&#x2F;修改密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改账号密码</span></span><br><span class="line"><span class="built_in">echo</span> 密码 | passwd --stdin 账号名</span><br></pre></td></tr></table></figure>

<h3 id="配置开机默认用户"><a href="#配置开机默认用户" class="headerlink" title="配置开机默认用户"></a>配置开机默认用户</h3><p>配置文件路径：<code>/etc/gdm/custom.conf</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">vim  /etc/gdm/custom.conf</span><br><span class="line"><span class="comment"># GDM configuration storage</span></span><br><span class="line">[daemon]</span><br><span class="line"><span class="comment"># Uncomment the line below to force the login screen to use Xorg</span></span><br><span class="line"><span class="comment">#WaylandEnable=false</span></span><br><span class="line">[security]</span><br><span class="line">[xdmcp]</span><br><span class="line">[chooser]</span><br><span class="line">[debug]</span><br><span class="line"><span class="comment"># Uncomment the line below to turn on debugging</span></span><br><span class="line"><span class="comment">#Enable=true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 [daemon] 下写入：</span></span><br><span class="line">AutomaticLoginEnable=True</span><br><span class="line">AutomaticLogin=&lt;用户名&gt;</span><br></pre></td></tr></table></figure>

<p>重启系统后即可自动进入你指定的账户了。</p>
<h2 id="配置静态IP地址"><a href="#配置静态IP地址" class="headerlink" title="配置静态IP地址"></a>配置静态IP地址</h2><h3 id="Centos-7配置静态IP地址"><a href="#Centos-7配置静态IP地址" class="headerlink" title="Centos 7配置静态IP地址"></a>Centos 7配置静态IP地址</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑网卡配置文件</span></span><br><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOOTPROTO=static     <span class="comment"># 静态</span></span><br><span class="line">IPADDR=10.0.0.181    <span class="comment"># IP地址</span></span><br><span class="line">PREFIX=24            <span class="comment"># 子网掩码</span></span><br><span class="line">DNS=10.0.0.1         <span class="comment"># DNS地址</span></span><br><span class="line">GATEWAY=10.0.0.1     <span class="comment"># 网关地址</span></span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">NAME=eth0</span><br><span class="line">DEVICE=eth0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span>           <span class="comment"># 开启自动启动</span></span><br><span class="line"><span class="comment">#重启网络</span></span><br><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure>

<h3 id="ubuntu配置静态IP地址"><a href="#ubuntu配置静态IP地址" class="headerlink" title="ubuntu配置静态IP地址"></a>ubuntu配置静态IP地址</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 18.04和20.04的网卡配置文件名是01-netcfg.yaml, 22.04版本变为00-installer-config.yaml</span></span><br><span class="line"><span class="comment"># 编辑网卡配置文件</span></span><br><span class="line">vim /etc/netplan/01-netcfg.yaml</span><br><span class="line">network:</span><br><span class="line">  ethernets:</span><br><span class="line">    eth0:                             <span class="comment">#网卡名</span></span><br><span class="line">      addresses: [10.0.0.182/24]      <span class="comment">#静态IP地址</span></span><br><span class="line">      dhcp4: no                       <span class="comment">#取消ipv4的dhcp</span></span><br><span class="line">      optional: <span class="literal">true</span></span><br><span class="line">      gateway4: 10.0.0.1              <span class="comment">#网关地址</span></span><br><span class="line">      nameservers:</span><br><span class="line">         addresses: [180.76.76.76,223.5.5.5 ]   <span class="comment">#DNS地址，多个用逗号分隔,中间不要有空格</span></span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line"><span class="comment">#重启网络</span></span><br><span class="line">sudo netplan apply</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2204配置静态IP地址,gateway4已经被弃用需要使用routes参数配置网关</span></span><br><span class="line">vim /etc/netplan/00-installer-config.yaml</span><br><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  ethernets:</span><br><span class="line">    ens33:</span><br><span class="line">      dhcp4: no</span><br><span class="line">      dhcp6: no</span><br><span class="line">      addresses:</span><br><span class="line">        - 10.0.0.10/24</span><br><span class="line">      routes:</span><br><span class="line">        - to: default</span><br><span class="line">          via: 10.0.0.2</span><br><span class="line">      nameservers:</span><br><span class="line">        addresses:</span><br><span class="line">          - 180.76.76.76</span><br><span class="line">          - 223.5.5.5</span><br><span class="line"><span class="comment"># 重启网络</span></span><br><span class="line">sudo netplan apply</span><br></pre></td></tr></table></figure>

<h3 id="Centos-8配置静态IP地址"><a href="#Centos-8配置静态IP地址" class="headerlink" title="Centos 8配置静态IP地址"></a>Centos 8配置静态IP地址</h3><p>在centos 8之后，使用<code>systemctl restart network</code>命令重启网络时，会出现以下报错:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Failed to restart network.service: Unit network.service not found.</span><br><span class="line">意思为无法重启网络服务，原因是无法找到network.service网络服务。</span><br></pre></td></tr></table></figure>

<p>在rhel8(含centos8)上，在&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;里也看不到任何脚本文件(centos7中此路径下包含网卡配置文件和一些脚本)，没有传统的network.service。因此只能通过NM命令工具集进行网络配置。换言之，在rhel8上，必须开启NM，否则无法使用网络。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑网卡配置文件</span></span><br><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-ens32</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=eth0</span><br><span class="line">UUID=066b4926-b40c-4c28-a5b4-2310d2b96613</span><br><span class="line">DEVICE=eth0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">IPADDR=192.168.1.200</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.1.254</span><br><span class="line">DNS1=223.5.5.5</span><br><span class="line">DNS2=180.76.76.76</span><br><span class="line">PREFIX=24</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重载重载ens32 网卡</span></span><br><span class="line">nmcli c reload eth0</span><br><span class="line"><span class="comment"># 启用connection（相当于ifup）</span></span><br><span class="line">nmcli c up eth0</span><br></pre></td></tr></table></figure>

<h3 id="nmcli常用命令一览"><a href="#nmcli常用命令一览" class="headerlink" title="nmcli常用命令一览"></a>nmcli常用命令一览</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/qianyuliang/archive/2019/09/26/11591970.html">Centos8 配置静态IP - 浅雨凉 - 博客园 (cnblogs.com)</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看ip（类似于ifconfig、ip addr）</span></span><br><span class="line">nmcli</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建connection，配置静态ip（等同于配置ifcfg，其中BOOTPROTO=none，并ifup启动）</span></span><br><span class="line">nmcli c add <span class="built_in">type</span> ethernet con-name ens32 ifname ens32 ipv4.addr 192.168.1.100/24 ipv4.gateway 192.168.1.1 ipv4.method manual</span><br><span class="line"><span class="comment"># 创建connection，配置动态ip（等同于配置ifcfg，其中BOOTPROTO=dhcp，并ifup启动）</span></span><br><span class="line">nmcli c add <span class="built_in">type</span> ethernet con-name ens32 ifname ens32 ipv4.method auto</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改ip（非交互式）</span></span><br><span class="line">nmcli c modify ens32 ipv4.addr <span class="string">&#x27;192.168.1.200/24&#x27;</span></span><br><span class="line">nmcli c up ens32</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启用connection（相当于ifup）</span></span><br><span class="line">nmcli c up ens32</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止connection（相当于ifdown）</span></span><br><span class="line">nmcli c down</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除connection（类似于ifdown并删除ifcfg）</span></span><br><span class="line">nmcli c delete ens32</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看connection列表</span></span><br><span class="line">nmcli c show</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看connection详细信息</span></span><br><span class="line">nmcli c show ens32</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重载所有ifcfg或route到connection（不会立即生效）</span></span><br><span class="line">nmcli c reload</span><br><span class="line"></span><br><span class="line"><span class="comment"># 立即生效connection，有3种方法</span></span><br><span class="line">nmcli c up ens32</span><br><span class="line">nmcli d reapply ens32</span><br><span class="line">nmcli d connect ens32</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看device详细信息</span></span><br><span class="line">nmcli d show      <span class="comment"># 查看所有device详细信息</span></span><br><span class="line">nmcli d show ens32  <span class="comment"># 查看指定device的详细信息</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看NM纳管状态</span></span><br><span class="line">nmcli n</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 开启NM纳管</span></span><br><span class="line">nmcli n on</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 关闭NM纳管（谨慎执行）</span></span><br><span class="line">nmcli n off</span><br></pre></td></tr></table></figure>

<h2 id="yum、apt的基本使用"><a href="#yum、apt的基本使用" class="headerlink" title="yum、apt的基本使用"></a>yum、apt的基本使用</h2><h3 id="yum-dnf常用命令"><a href="#yum-dnf常用命令" class="headerlink" title="yum&#x2F;dnf常用命令"></a>yum&#x2F;dnf常用命令</h3><p>DNF，即DaNdiFied，是新一代的RPM软件包管理器。DNF 发行日期是2015年5月11日，DNF 包管理器采用Python 编写，发行许可为GPL v2，首先出现在Fedora 18 发行版中。在 RHEL 8.0 版本正式取代了 YUM，DNF包管理器克服了YUM包管理器的一些瓶颈，提升了包括用户体验，内存占用，依赖分析，运行速度等.</p>
<p>yum客户端配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/yum.conf               <span class="comment">#为所有仓库提供公共配置</span></span><br><span class="line">/etc/yum.repos.d/*.repo：   <span class="comment">#为每个仓库的提供配置文件</span></span><br></pre></td></tr></table></figure>

<p>常用命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">yum instll -y package_name    <span class="comment"># 安装指定软件包并确认安装</span></span><br><span class="line">yum update                    <span class="comment"># 更新系统中所有软件包</span></span><br><span class="line">yum upgrade package_name      <span class="comment"># 升级指定的软件包：</span></span><br><span class="line">yum repolist                  <span class="comment"># 列出可用的镜像源</span></span><br><span class="line">yum list                      <span class="comment"># 列出所有可用的package和package组,会有大量输出</span></span><br><span class="line">yum clean all                 <span class="comment"># 清除所有缓冲数据</span></span><br><span class="line">yum makecache                 <span class="comment"># 缓存本地yum源</span></span><br><span class="line">yum provides httpd            <span class="comment"># 查看提供某个命令的rpm包</span></span><br><span class="line">yum deplist httpd             <span class="comment"># 列出一个包所有依赖的包</span></span><br><span class="line">yum remove package_name       <span class="comment"># 删除指定软件包</span></span><br><span class="line">yum install --downloadonly --downloaddir=/package_installdir/ package_name  <span class="comment"># 软件包仅下载不安装,如果下载的包有依赖也会一起下载. 如果提示没有--downloadonly选项则需要安装yum-plugin-downloadonly软件包(只有centos 6需要)；</span></span><br><span class="line">yum search package_name        <span class="comment"># 搜索可用的软件包</span></span><br><span class="line">yum info package_name          <span class="comment"># 显示已安装的软件包的信息</span></span><br><span class="line">yum installed                  <span class="comment"># 查看已经安装的包</span></span><br><span class="line">yum list available             <span class="comment"># 查看可安装的包</span></span><br><span class="line">yum list updates               <span class="comment"># 查看可以升级的包</span></span><br><span class="line">yum check-update               <span class="comment"># 检查更新</span></span><br></pre></td></tr></table></figure>

<p>yum仓库管理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum repolist all               <span class="comment"># 显示所有资源库</span></span><br><span class="line">yum repolist enabled           <span class="comment"># 显示所有已启动的资源库</span></span><br><span class="line">yum repolist disabled          <span class="comment"># 显示所有被禁用的资源库</span></span><br><span class="line">yum-config-manager --<span class="built_in">disable</span> epel   <span class="comment"># 禁用仓库epel</span></span><br><span class="line">yum-config-manager --<span class="built_in">enable</span> epel    <span class="comment">#启用仓库epel</span></span><br></pre></td></tr></table></figure>

<h3 id="apt常用命令"><a href="#apt常用命令" class="headerlink" title="apt常用命令"></a>apt常用命令</h3><p>apt 相当于 <code>apt-get、apt-cache </code>和 <code>apt-config </code>中最常用命令选项的集合</p>
<p>apt 具有更精减但足够的命令选项，而且参数选项的组织方式更为有效。此外，启用的几个特性也非常 有帮助。例如：可以在使用 apt 命令安装或删除程序时看到进度条,apt 还会在更新存储库数据库时提示</p>
<p>用户可升级的软件包个数 apt 与 apt-get 有一些类似的命令选项，但它并不能完全向下兼容 apt-get 命令,也即可用 apt 替换部分 apt-get 系列命令，但不是全部.</p>
<p>APT包索引配置文件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/apt/sources.list </span><br><span class="line">/etc/apt/sources.list.d</span><br></pre></td></tr></table></figure>

<p>常用命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">apt list                  <span class="comment">#列出包含条件的包（已安装，可升级等），等于yum list</span></span><br><span class="line">apt list --installed      <span class="comment">#列出已安装的软件包</span></span><br><span class="line">apt edit-sources          <span class="comment">#编辑source源⽂件</span></span><br><span class="line">apt search apache2        <span class="comment">#搜索安装包apache2</span></span><br><span class="line">apt show apache2          <span class="comment">#或者apt-cache show apache2 更详细, 查看仓库中软件包的详细信息</span></span><br><span class="line">apt-cache madison nginx   <span class="comment">#查看仓库中软件包有哪些版本可以安装</span></span><br><span class="line">apt install apache2       <span class="comment">#或者apt-get install apache2, 在线安装软件包apache2</span></span><br><span class="line">apt install nginx=1.14.0-0ubuntu1.6     <span class="comment">#安装软件包的时候指定安装具体的版本,配合apt-cache madison使用</span></span><br><span class="line">apt remove apache2        <span class="comment">#卸载单个软件包但是保留配置⽂件</span></span><br><span class="line">apt purge apache2         <span class="comment">#卸载单个软件包以及删除配置⽂件</span></span><br><span class="line">apt autoremove apache2    <span class="comment">#删除安装包并解决依赖关系</span></span><br><span class="line">apt update                <span class="comment">#更新本地软件包列表索引，修改了apt仓库后必须执⾏</span></span><br><span class="line">apt upgrade               <span class="comment">#升级所有已安装且可升级到新版本的软件包</span></span><br><span class="line">apt full-upgrade          <span class="comment"># 或者apt-get dist-upgrade, 在线升级整个系统软件包,自动处理依赖关系，必要时可以移除旧软件包。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看文件来自于哪个包,类似redhat中的yum provides &lt;filename&gt;</span></span><br><span class="line">apt-file search <span class="string">&#x27;string&#x27;</span>  <span class="comment">#默认是包含此字符串的文件</span></span><br><span class="line">apt-file search -x  <span class="string">&#x27;正则表达式&#x27;</span></span><br><span class="line">apt-file search -F /path/file</span><br><span class="line"></span><br><span class="line"><span class="comment">#查询软件xxx依赖哪些包</span></span><br><span class="line">apt depends xxx</span><br><span class="line">apt-cache depends xxx</span><br><span class="line"></span><br><span class="line"><span class="comment">#查询软件xxx被哪些包依赖</span></span><br><span class="line">apt rdepends xxx</span><br><span class="line">apt-cache rdepends xxx</span><br></pre></td></tr></table></figure>

<h3 id="安装常用软件包"><a href="#安装常用软件包" class="headerlink" title="安装常用软件包"></a>安装常用软件包</h3><p>ubuntu</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt install purge ufw lxd lxd-client lxcfs lxc-common</span><br><span class="line">apt install iproute2 ntpdate tcpdump telnet traceroute nfs-kernel-server nfs-common lrzsz tree openssl libssl-dev libpcre3 libpcre3-dev zlib1g-dev ntpdate tcpdump telnet traceroute gcc openssh-server lrzsz tree openssl libssl-dev libpcre3 libpcre3-dev zlib1g-dev ntpdate tcpdump telnet traceroute iotop unzip zip libevent-dev</span><br><span class="line">apt install procps         <span class="comment"># top 命令</span></span><br><span class="line">apt install iputils-ping   <span class="comment"># ping 命令</span></span><br><span class="line">apt install net-tools      <span class="comment"># 网络工具</span></span><br></pre></td></tr></table></figure>

<p>centos</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最小化安装建议的软件包</span></span><br><span class="line">yum install gcc make autoconf gcc-c++ glibc glibc-devel pcre pcre-devel openssl openssl-devel systemd-devel zlib-devel vim lrzsz tree tmux lsof tcpdump wget net-tools iotop bc bzip2 zip unzip nfs-utils man-pages autofs</span><br></pre></td></tr></table></figure>

<h2 id="rpm、dpkg包的基本查询和使用"><a href="#rpm、dpkg包的基本查询和使用" class="headerlink" title="rpm、dpkg包的基本查询和使用"></a>rpm、dpkg包的基本查询和使用</h2><h3 id="rpm常用命令"><a href="#rpm常用命令" class="headerlink" title="rpm常用命令"></a>rpm常用命令</h3><p>RPM包默认安装路径: 通常情况下，RPM 包采用系统默认的安装路径，所有安装文件会按照类别分散安装到目录中。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认安装路径	            含 义</span></span><br><span class="line">/etc/	                     <span class="comment"># 配置文件安装目录</span></span><br><span class="line">/usr/bin/	                 <span class="comment"># 可执行的命令安装目录</span></span><br><span class="line">/usr/lib/	                 <span class="comment"># 程序所使用的函数库保存位置</span></span><br><span class="line">/usr/share/doc/	             <span class="comment"># 基本的软件使用手册保存位置</span></span><br><span class="line">/usr/share/man/	             <span class="comment"># 帮助文件保存位置</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># rpm常用命令</span></span><br><span class="line">rpm -Uvh 包全名               <span class="comment"># RPM 包的升级</span></span><br><span class="line">rpm -ivh xxx.rpm             <span class="comment"># 安装 RPM, 后跟详细路径,h显示进度,v显示过程</span></span><br><span class="line">rpm -ivh xxx.rpm --force     <span class="comment"># 强行安装</span></span><br><span class="line">rpm -e 包全名                 <span class="comment"># 卸载</span></span><br><span class="line">rpm -qa vsftpd               <span class="comment"># 查询安装的包,后跟明确的包名,以vsftpd为例</span></span><br><span class="line">rpm -qa |<span class="built_in">wc</span> -l               <span class="comment"># 列出所有安装的包,并统计数量</span></span><br><span class="line">rpm -qa |grep vsft           <span class="comment"># 利用grep进行模糊搜索,如搜索vsftpd包</span></span><br><span class="line">rpm -qi vsftpd               <span class="comment"># 查看包的信息,安装日期等</span></span><br><span class="line">rpm -ql vsftpd               <span class="comment"># 列出包中所有文件列表</span></span><br><span class="line">rpm -qc vsftpd               <span class="comment"># 列出包的配置文件</span></span><br><span class="line">rpm -q --scripts vsftpd      <span class="comment">#列出包中的脚本文件</span></span><br><span class="line">rpm -qf /etc/issue           <span class="comment"># 查看某个文件来自哪个包,如/etc/issue</span></span><br></pre></td></tr></table></figure>

<h3 id="dpkg常用命令"><a href="#dpkg常用命令" class="headerlink" title="dpkg常用命令"></a>dpkg常用命令</h3><p>注意：一般建议不要使用dpkg卸载软件包。因为删除包时，其它依赖它的包不会卸载，并且可能无法再正常运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安装包</span></span><br><span class="line">dpkg -i package.deb </span><br><span class="line"></span><br><span class="line"><span class="comment">#删除包，不建议，不自动卸载依赖于它的包</span></span><br><span class="line">dpkg -r package </span><br><span class="line"></span><br><span class="line"><span class="comment">#删除包（包括配置文件）</span></span><br><span class="line">dpkg -P package </span><br><span class="line"></span><br><span class="line"><span class="comment">#列出当前已安装的包，类似rpm -qa</span></span><br><span class="line">dpkg -l</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看软件包信息</span></span><br><span class="line">dpkg -I package.deb</span><br><span class="line"></span><br><span class="line"><span class="comment">#列出该包的状态，包括详细信息，类似rpm –qi</span></span><br><span class="line">dpkg -s package </span><br><span class="line"></span><br><span class="line"><span class="comment">#列出该包中所包含的文件，类似rpm –ql </span></span><br><span class="line">dpkg -L package </span><br><span class="line"></span><br><span class="line"><span class="comment">#搜索包含pattern的包，类似rpm –qf </span></span><br><span class="line">dpkg -S &lt;pattern&gt; </span><br><span class="line"></span><br><span class="line"><span class="comment">#配置包，-a 使用，配置所有没有配置的软件包</span></span><br><span class="line">dpkg --configure package </span><br><span class="line"></span><br><span class="line"><span class="comment">#列出 deb 包的内容，⽂件及⽬录内容,类似rpm –qpl </span></span><br><span class="line">dpkg -c package.deb </span><br><span class="line"></span><br><span class="line"><span class="comment">#解开 deb 包的内容</span></span><br><span class="line">dpkg --unpack package.deb</span><br></pre></td></tr></table></figure>

<h2 id="配置sshd-root远程登陆"><a href="#配置sshd-root远程登陆" class="headerlink" title="配置sshd root远程登陆"></a>配置sshd root远程登陆</h2><p>默认情况下，ubuntu不允许root⽤⼾远程ssh，如果有实际场景需要允许 root⽤⼾远程ssh，则需要设置root密码，并且编辑&#x2F;etc&#x2F;ssh&#x2F;sshd_config ⽂件(注意,不是&#x2F;etc&#x2F;ssh&#x2F;ssh_config文件)修改如下 :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line">32 <span class="comment">#PermitRootLogin prohibit-password  #默认为禁⽌登录</span></span><br><span class="line">33 PermitRootLogin <span class="built_in">yes</span>   <span class="comment">#改为允许登录</span></span><br><span class="line">57 <span class="comment">#PasswordAuthentication yes</span></span><br><span class="line">58 PasswordAuthentication <span class="built_in">yes</span> <span class="comment">#打开密码认证，其实默认就是允许通过密码认证登录</span></span><br><span class="line"></span><br><span class="line">su - root    <span class="comment">#切换到root⽤户环境</span></span><br><span class="line">passwd root  <span class="comment">#设置密码</span></span><br><span class="line">systemctl restart sshd <span class="comment">#重启ssh服务并测试root⽤户远程ssh连接</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用命令修改ssd配置文件</span></span><br><span class="line">sudo sed -i <span class="string">&#x27;s/^#\?PermitRootLogin.*/PermitRootLogin yes/g&#x27;</span> /etc/ssh/sshd_config;</span><br><span class="line">sudo sed -i <span class="string">&#x27;s/^#\?PasswordAuthentication.*/PasswordAuthentication yes/g&#x27;</span> /etc/ssh/sshd_config;</span><br><span class="line"><span class="comment"># 重启服务</span></span><br><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></figure>

<h2 id="修改网卡名称为eth0"><a href="#修改网卡名称为eth0" class="headerlink" title="修改网卡名称为eth0"></a>修改网卡名称为eth0</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑grub配置文件/etc/sysconfig/grub</span></span><br><span class="line">sudo vim /etc/default/grub</span><br><span class="line"><span class="comment"># 在GRUB_CMDLINE_LINUX前面添加参数net.ifnames=0 biosdevname=0，前后使用空格分隔</span></span><br><span class="line">GRUB_CMDLINE_LINUX=<span class="string">&quot;net.ifnames=0 biosdevname=0 find_preseed=/preseed.cfg auto noprompt priority=critical locale=en_US&quot;</span></span><br><span class="line"><span class="comment"># ubuntu重新生成grub配置并更新内核参数</span></span><br><span class="line">grub-mkconfig -o /boot/grub/grub.cfg  </span><br><span class="line"><span class="comment">#centos重新生成grub配置并更新内核参数</span></span><br><span class="line">grub2-mkconfig -o /boot/grub2/grub.cfg  </span><br><span class="line"><span class="comment"># 或者都可以使用下面的命令更新grub配置</span></span><br><span class="line">sudo update-grub</span><br><span class="line"><span class="comment"># 重启</span></span><br><span class="line">reboot</span><br><span class="line"></span><br><span class="line"><span class="comment">#centos修改网卡配置文件: 复制网卡配置文件, 名称可能会不同</span></span><br><span class="line"><span class="built_in">cp</span> /etc/sysconfig/network-scripts/ifcfg-ens33 /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line"><span class="comment">#编辑网卡配置文件, 修改网卡名称</span></span><br><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">IPADDR=10.0.0.181</span><br><span class="line">PREFIX=24</span><br><span class="line">DNS=10.0.0.1</span><br><span class="line">GATEWAY=10.0.0.1</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">NAME=eth0      <span class="comment">#修改为新的eth0</span></span><br><span class="line">DEVICE=eth0    <span class="comment">#修改为新的eth0</span></span><br><span class="line">ONBOOT=<span class="built_in">yes</span>   </span><br><span class="line"><span class="comment">#重启网络</span></span><br><span class="line">systemctl restart network</span><br><span class="line"></span><br><span class="line"><span class="comment"># ubuntu修改网卡配置文件, 名称可能不同，使用tab补全即可</span></span><br><span class="line">vim /etc/netplan/01-netcfg.yaml</span><br><span class="line">network:</span><br><span class="line">  ethernets:</span><br><span class="line">    eth0:                             <span class="comment">#修改网卡名</span></span><br><span class="line">      addresses: [10.0.0.182/24]      <span class="comment">#静态IP地址</span></span><br><span class="line">      dhcp4: no                       <span class="comment">#取消ipv4的dhcp</span></span><br><span class="line">      optional: <span class="literal">true</span></span><br><span class="line">      gateway4: 10.0.0.1              <span class="comment">#网关地址</span></span><br><span class="line">      nameservers:</span><br><span class="line">         addresses: [180.76.76.76,223.5.5.5 ] <span class="comment">#DNS地址，多个用逗号分隔</span></span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line"><span class="comment">#重启网络</span></span><br><span class="line">sudo netplan apply</span><br></pre></td></tr></table></figure>

<h2 id="查看和关闭防火墙"><a href="#查看和关闭防火墙" class="headerlink" title="查看和关闭防火墙"></a>查看和关闭防火墙</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># centos 7/8</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl <span class="built_in">disable</span> --now firewalld</span><br><span class="line">systemctl status firewalld</span><br><span class="line"></span><br><span class="line"><span class="comment"># ubuntu</span></span><br><span class="line">sudo ufw <span class="built_in">disable</span> &amp;&amp; sudo ufw status</span><br></pre></td></tr></table></figure>

<h2 id="查看和关闭Selinux"><a href="#查看和关闭Selinux" class="headerlink" title="查看和关闭Selinux"></a>查看和关闭Selinux</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu 中默认没有安装 SELinux, Ubuntu有一个类似于SELinux的强制访问控制系统，名为AppArmor。</span></span><br><span class="line">sudo systemctl status apparmor  <span class="comment"># 查看apparmor状态</span></span><br><span class="line">sudo systemctl stop apparmor    <span class="comment"># 停止apparmor</span></span><br><span class="line">sudo systemctl <span class="built_in">disable</span> apparmor <span class="comment"># 禁止apparmor</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看selinux状态</span></span><br><span class="line">sestatus   <span class="comment"># 或者 getenforce</span></span><br><span class="line"><span class="comment"># 查看selinux配置文件, SELinux共有3个状态enforcing （执行中）、permissive（不执行但产生警告）、disabled（关闭）</span></span><br><span class="line"><span class="built_in">cat</span> /etc/selinux/config</span><br><span class="line"><span class="comment">#临时关闭selinux, 设置为permissive模式；setenforce 1 设置为enforcing模式；</span></span><br><span class="line">setenforce 0   </span><br><span class="line"><span class="comment">#永久关闭selinux需要编辑配置文件</span></span><br><span class="line">sed -i <span class="string">&#x27;s#SELINUX=enforcing#SELINUX=disabled#g&#x27;</span> /etc/selinux/config</span><br></pre></td></tr></table></figure>

<h2 id="查看和关闭swap分区"><a href="#查看和关闭swap分区" class="headerlink" title="查看和关闭swap分区"></a>查看和关闭swap分区</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">swapoff -a   <span class="comment"># 临时关闭</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 永久关闭swap需要编辑配置文件,将swap分区注释掉并重启生效</span></span><br><span class="line">vim /etc/fstab</span><br><span class="line">/dev/mapper/rl-root     /                       xfs     defaults        0 0</span><br><span class="line">UUID=e309bcf8-7056-4f7d-961a-3e6c8b1e2c48 /boot                   xfs     defaults        0 0</span><br><span class="line">UUID=D330-01CD          /boot/efi               vfat    <span class="built_in">umask</span>=0077,shortname=winnt 0 2</span><br><span class="line">/dev/mapper/rl-home     /home                   xfs     defaults        0 0</span><br><span class="line"><span class="comment"># /dev/mapper/rl-swap     none                    swap    defaults        0 0   #注释掉swap分区</span></span><br></pre></td></tr></table></figure>

<h2 id="配置系统服务systemd"><a href="#配置系统服务systemd" class="headerlink" title="配置系统服务systemd"></a>配置系统服务systemd</h2><p>systemd（是的，全小写，即使在句子开头也是小写），是初始化程序（init）和 SystemV 初始化脚本的现代替代者。</p>
<p>像 init 一样，systemd 是所有进程之母，它负责使 Linux 主机启动到可以做生产性任务的状态。systemd 设定的一些功能比老的初始化程序要广泛得多，它要管理正在运行的 Linux 主机的许多方面，包括挂载文件系统、管理硬件、处理定时器以及启动和管理生产性主机所需的系统服务。</p>
<h3 id="centos6"><a href="#centos6" class="headerlink" title="centos6"></a>centos6</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">service [服务] start     <span class="comment"># 启动服务</span></span><br><span class="line">service [服务] stop      <span class="comment">#停止服务</span></span><br><span class="line">service [服务] restart   <span class="comment">#重启服务</span></span><br><span class="line">service [服务] status    <span class="comment">#查看服务状态</span></span><br><span class="line">chkconfig [服务] on      <span class="comment">#设置服务在各等级为on,开机启动，“各等级”包括2、3、4、5等级</span></span><br><span class="line">chkconfig [服务] off     <span class="comment">#设置服务禁止开机启动</span></span><br><span class="line">chkconfig --add name    <span class="comment">#添加service, 添加一个chkconfig管理的service，并在/etc/rc[0-6].d 目录下添加相应的符号链接</span></span><br><span class="line">chkconfig --del name    <span class="comment">#删除service, 从chkconfig 管理名单中删除该service，并且删除 /etc/rc[0-6].d 目录下所有与之关联的符号链接</span></span><br><span class="line">chkconfig --list [name]  <span class="comment"># 列出service的启动信息, 如果不指定name，会列出所有services的信息。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置service运行级别</span></span><br><span class="line">chkconfig --level 2345 httpd on     <span class="comment">#设置httpd在运行级别为2、3、4的情况下都是on（开启）的状态</span></span><br><span class="line"><span class="comment">#指定运行级为2,3,4,5</span></span><br><span class="line"><span class="comment">#等级0表示：表示关机</span></span><br><span class="line"><span class="comment">#等级1表示：单用户模式</span></span><br><span class="line"><span class="comment">#等级2表示：无网络连接的多用户命令行模式</span></span><br><span class="line"><span class="comment">#等级3表示：有网络连接的多用户命令行模式</span></span><br><span class="line"><span class="comment">#等级4表示：不可用</span></span><br><span class="line"><span class="comment">#等级5表示：带图形界面的多用户模式</span></span><br><span class="line"><span class="comment">#等级6表示：重新启动</span></span><br></pre></td></tr></table></figure>

<h3 id="centos7-8、ubuntu"><a href="#centos7-8、ubuntu" class="headerlink" title="centos7&#x2F;8、ubuntu"></a>centos7&#x2F;8、ubuntu</h3><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1516125">可能是史上最全面易懂的 Systemd 服务管理教程！( 强烈建议收藏 )-腾讯云开发者社区-腾讯云 (tencent.com)</a></p>
<p>常用命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置文件</span></span><br><span class="line">/etc/systemd/system：系统或用户自定义的配置文件   Ubuntu: Unit文件指向该目录</span><br><span class="line">/run/systemd/system：软件运行时生成的配置文件</span><br><span class="line">/usr/lib/systemd/system：系统或第三方软件安装时添加的配置文件。 CentOS 7/8：Unit 文件指向该目录</span><br><span class="line"></span><br><span class="line">systemctl daemon-reload        <span class="comment">#重新加载服务，每次修改了 unit 的配置文件后，需要执行以下命令重新加载 unit 的配置文件</span></span><br><span class="line">systemctl <span class="built_in">enable</span> docker        <span class="comment">#设置开机自动启动docker</span></span><br><span class="line">systemctl status docker        <span class="comment">#查看 docker服务状态</span></span><br><span class="line">systemctl start docker         <span class="comment">#启动docker</span></span><br><span class="line">systemctl <span class="built_in">enable</span> --now docker  <span class="comment">#立即启动并设置为开机启动</span></span><br><span class="line">systemctl <span class="built_in">disable</span> docker       <span class="comment">#取消 unit 开机启动</span></span><br><span class="line"></span><br><span class="line">systemctl is-enabled docker    <span class="comment">#查看 unit 是否开机启动</span></span><br><span class="line">systemctl <span class="built_in">cat</span> docker.service   <span class="comment">#查看 Unit 配置文件的内容</span></span><br><span class="line">systemctl -H root@rhel7.example.com status httpd.service   <span class="comment"># 显示远程主机的某个 Unit 的状态</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出所有正在运行的服务（即所有已加载和正在运行的服务）</span></span><br><span class="line">systemctl list-units --<span class="built_in">type</span>=service --state=running   <span class="comment">#或者 systemctl --type=service --state=running</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出所有已加载但处于活动状态的服务，包括正在运行的服务和已退出的服务，可以添加--state选项，其值为active</span></span><br><span class="line">systemctl list-units --<span class="built_in">type</span>=service --state=active    <span class="comment">#或者 systemctl --type=service --state=active</span></span><br></pre></td></tr></table></figure>

<p>target启动管理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前系统的所有 Target</span></span><br><span class="line">systemctl list-unit-files --<span class="built_in">type</span>=target</span><br><span class="line"></span><br><span class="line">systemctl list-units --<span class="built_in">type</span>=target  <span class="comment"># 获取当前正在使用的运行target</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看一个 Target 包含的所有 Unit</span></span><br><span class="line">systemctl list-dependencies multi-user.target</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看启动时的默认Target运行级别</span></span><br><span class="line">systemctl get-default</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置启动时的默认 Target运行级别为mulit-user,进入图形化界面,需要重启才能看到效果</span></span><br><span class="line">systemctl set-default multi-user.target</span><br><span class="line"><span class="comment"># 设置启动时的默认 Target运行级别为mulit-user, 不进入图形界面的多用户模式,需要重启才能看到效果。</span></span><br><span class="line">systemctl set-default graphical.target</span><br><span class="line"></span><br><span class="line">systemctl isolate multi-user.target	   <span class="comment"># 在不重启的情况下，切换到运行级别mulit-user下</span></span><br><span class="line">systemctl isolate graphical.target	   <span class="comment"># 在不重启的情况下，切换到图形界面下</span></span><br></pre></td></tr></table></figure>

<p>systemctl: 用于检查和控制各种系统服务和资源的状态</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重启系统</span></span><br><span class="line">systemctl reboot</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭系统，切断电源</span></span><br><span class="line">systemctl poweroff</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入睡眠模式,暂停系统</span></span><br><span class="line">systemctl <span class="built_in">suspend</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 系统进入休眠状态</span></span><br><span class="line">systemctl hibernate</span><br><span class="line"></span><br><span class="line"><span class="comment"># 让系统进入交互式休眠状态</span></span><br><span class="line">systemctl hybrid-sleep</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强制进入救援状态（单用户状态）</span></span><br><span class="line">systemctl rescue</span><br><span class="line"><span class="comment"># 强制进入紧急救援模式</span></span><br><span class="line">systemctl emergency</span><br></pre></td></tr></table></figure>

<p>systemd-analyze: 显示此次系统启动时运行每个服务所消耗的时间，可以用于分析系统启动过程中的性能瓶颈</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看启动耗时</span></span><br><span class="line">systemd-analyze</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看每个服务的启动耗时</span></span><br><span class="line">systemd-analyze blame</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示瀑布状的启动过程流</span></span><br><span class="line">systemd-analyze critical-chain</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示指定服务的启动流</span></span><br><span class="line">systemd-analyze critical-chain atd.service</span><br></pre></td></tr></table></figure>

<p>hostnamectl: 查看和修改系统的主机名和主机信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示当前主机的信息</span></span><br><span class="line">hostnamectl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置主机名。</span></span><br><span class="line">hostnamectl set-hostname rhel7</span><br></pre></td></tr></table></figure>

<p>timedatectl: 用于查看和管理系统的时间和时区信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前时区设置</span></span><br><span class="line">timedatectl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有可用的时区</span></span><br><span class="line">timedatectl list-timezones</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置当前时区</span></span><br><span class="line">timedatectl set-timezone America/New_York   <span class="comment">#设置时区为美国纽约</span></span><br><span class="line">timedatectl set-timezone Asia/Shanghai      <span class="comment">#设置时区为中国上海</span></span><br><span class="line">timedatectl set-time YYYY-MM-DD             <span class="comment">#设置年,月,日</span></span><br><span class="line">timedatectl set-time HH:MM:SS               <span class="comment">#设置时间:小时,分钟,秒</span></span><br></pre></td></tr></table></figure>

<p>loginctl: 用于管理系统已登录用户和 Session 的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出当前 session</span></span><br><span class="line">loginctl list-sessions</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出当前登录用户</span></span><br><span class="line">loginctl list-users</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出显示指定用户的信息</span></span><br><span class="line">loginctl show-user ruanyf</span><br></pre></td></tr></table></figure>

<p>systemd-ask-password: 辅助性工具，用星号屏蔽用户的任意输入，然后返回实际输入的内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PASSWORD=$(systemd-ask-password <span class="string">&quot;Input Your Passowrd:&quot;</span>)</span><br><span class="line">systemd-detect-virt</span><br></pre></td></tr></table></figure>

<p>systemd-detect-virt：显示主机的虚拟化类型</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemd-detect-virt</span><br></pre></td></tr></table></figure>

<p>systemd-run: 用于将任意指定的命令包装成一个临时的后台服务运行</p>
<p><a target="_blank" rel="noopener" href="https://www.jinbuguo.com/systemd/systemd-run.html">systemd-run 中文手册 金步国</a></p>
<p>systemd-run 可以将一个指定的操作变成后台运行的服务。它的效果似乎与直接在命令后加上表示后台运行的 &amp; 符号很相似。然而，它让命令成为服务还意味着，它的生命周期将由 Systemd 控制。具体来说，包括以下好处：</p>
<ul>
<li>服务的生命击期由 Systemd 接管，不会随着启动它的控制台关闭而结束</li>
<li>可以通过 systemctl 工具管理服务的状态</li>
<li>可以通过 journalctl 工具查看和管理服务的日志信息</li>
<li>可以通过 Systemd 提供的方法限制服务的 CPU、内存、磁盘 IO 等系统资源的使用情况。</li>
</ul>
<h3 id="systemd-unit配置文件"><a href="#systemd-unit配置文件" class="headerlink" title="systemd unit配置文件"></a>systemd unit配置文件</h3><p>[systemd.index 中文手册 ]<a target="_blank" rel="noopener" href="https://www.jinbuguo.com/systemd/systemd.index.htm">https://www.jinbuguo.com/systemd/systemd.index.htm</a></p>
<p>unit部分: <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.unit.html">systemd.unit 中文手册</a></p>
<p>service部分: <a target="_blank" rel="noopener" href="https://www.freedesktop.org/software/systemd/man/systemd.service.html">systemd.service</a></p>
<p>如何杀死进程: <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.kill.html">systemd.kill 中文手册</a></p>
<p>进程环境变量: <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.exec.html">systemd.exec 中文手册</a></p>
<p>常见service unit文件示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># prometheus, 注意,每个单元之间必须有空行分开</span></span><br><span class="line">vi /usr/lib/systemd/system/prometheus.service</span><br><span class="line">[Unit] </span><br><span class="line">Description=Prometheus server daemon</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">User=prometheus       <span class="comment">#运行的用户</span></span><br><span class="line">Group=prometheus      <span class="comment">#运行的组</span></span><br><span class="line">KillMode=process</span><br><span class="line">Restart=on-failure</span><br><span class="line">ExecStart=/usr/local/prometheus/prometheus --config.file <span class="string">&quot;/usr/local/prometheus/prometheus.yml&quot;</span> --web.listen-address <span class="string">&quot;0.0.0.0:9090&quot;</span> --storage.tsdb.retention.time=60d <span class="comment">#数据默认保存时间为15天，启动时加上此参数可以控制数据保存时间</span></span><br><span class="line">ExecReload=/bin/kill -HUP <span class="variable">$MAINPID</span></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p>service unit文件说明</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker</span></span><br><span class="line">vim /usr/lib/systemd/system/docker.service</span><br><span class="line">[Unit]</span><br><span class="line">Description=Docker Application Container Engine     <span class="comment"># 当前 unit 的描述</span></span><br><span class="line">Documentation=https://docs.docker.com               <span class="comment"># 文档地址</span></span><br><span class="line">After=network-online.target firewalld.service time-set.target   <span class="comment"># 表示本 unit 应该在某服务之后启动,只涉及启动顺序，不涉及依赖关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 服务的依赖关系:</span></span><br><span class="line"><span class="comment">#Requires：表示本 unit 与其它 unit 之间存在强依赖关系，如果本 unit 被激活，此处列出的 unit 也会被激活，如果其中一个依赖的 unit 无法激活，systemd 都不会启动本 unit. </span></span><br><span class="line"><span class="comment">#Wants: 如果依赖的 unit 启动失败，不影响本 unit 的继续运行</span></span><br><span class="line"><span class="comment">#BindsTo：当指定的 unit 停止时，也会导致本 unit 停止</span></span><br><span class="line"><span class="comment">#PartOf：当指定的 unit 停止或重启时，也会导致本 unit 停止或重启</span></span><br><span class="line">Wants=network-online.target  </span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line"><span class="comment"># 设置进程的启动类型。必须设为 simple, exec, forking, oneshot, dbus, notify, idle之一</span></span><br><span class="line"><span class="comment">#simple: 默认值, ExecStart= 进程就是该服务的主进程， 并且 systemd 会认为在创建了该服务的主服务进程之后，该服务就已经启动完成。</span></span><br><span class="line"><span class="comment">#notify: 该服务将会在启动完成之后通过 [sd_notify](https://www.jinbuguo.com/systemd/sd_notify.html) 之类的接口发送一个通知消息。systemd 将会在启动后继单元之前， 首先确保该进程已经成功的发送了这个消息。</span></span><br><span class="line"><span class="comment">#dbus: 该服务只有获得了 BusName=指定的 D-Bus 名称之后，systemd 才会认为该服务启动完成，才会开始启动后继单元。 设为此类型相当于隐含的依赖于 dbus.socket 单元。</span></span><br><span class="line"><span class="comment">#forking: ExecStart=进程将会在启动过程中使用 fork()系统调用。 也就是当所有通信渠道都已建好、启动亦已成功之后，父进程将会退出，而子进程将作为主服务进程继续运行。 这是传统UNIX守护进程的经典做法。 在这种情况下，systemd 会认为在父进程退出之后，该服务就已经启动完成。 如果使用了此种类型，那么建议同时设置 PIDFile= 选项，以帮助 systemd 准确可靠的定位该服务的主进程。 systemd 将会在父进程退出之后 立即开始启动后继单元。</span></span><br><span class="line"><span class="comment">#idle: 与 simple`类似，不同之处在于， 服务进程将会被延迟到所有活动任务都完成之后再执行。</span></span><br><span class="line"><span class="comment">#exec: 只有在该服务的主服务进程执行完成之后，systemd 才会认为该服务启动完成。 其他后继单元必须一直阻塞到这个时间点之后才能继续启动。</span></span><br><span class="line"><span class="comment">#建议对长时间持续运行的服务尽可能使用 `Type=simple` (这是最简单和速度最快的选择)。 注意，simple类型的服务无法报告启动失败、也无法在服务完成初始化后对其他单元进行排序</span></span><br><span class="line"><span class="comment">#当当客户端需要通过仅由该服务本身创建的IPC通道(而非由 systemd 创建的套接字或 D-bus 之类)连接到该服务的时候, notify或 dbus(该服务必须提供 D-Bus 接口) 才是最佳选择， 这两种类型都允许服务进程精确的安排何时算是服务启动成功、何时可以继续启动后继单元。 notify类型需要服务进程明确使用 sd_notify()函数或类似的API， 否则，可以使用 forking作为替代(它支持传统的UNIX服务启动协议)。</span></span><br><span class="line">Type=notify</span><br><span class="line"></span><br><span class="line">ExecStart=/usr/local/bin/dockerd    <span class="comment">#服务启动时执行的命令和参数</span></span><br><span class="line">ExecReload=/bin/kill -s HUP <span class="variable">$MAINPID</span>    <span class="comment"># 重启服务时执行的命令</span></span><br><span class="line">TimeoutStartSec=0     <span class="comment">#等待服务停止/启动的时间（以秒为单位）</span></span><br><span class="line">RestartSec=2      <span class="comment"># 重新启动服务前的睡眠时间（以秒为单位）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置当服务的进程退出、被杀死或达到超时时是否重新启动服务</span></span><br><span class="line"><span class="comment">#no 服务将不会重新启动，这是默认设置</span></span><br><span class="line"><span class="comment">#on-failure 仅在服务进程异常退出时重启，所谓“异常退出”是指：退出码不为&quot;0&quot;</span></span><br><span class="line"><span class="comment">#on-abnormal 如果进程因信号或超时而终止时重新启动</span></span><br><span class="line"><span class="comment">#always 总是重新启动</span></span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line">StartLimitBurst=3</span><br><span class="line">StartLimitInterval=60s</span><br><span class="line"></span><br><span class="line"><span class="comment"># PIDFile=该服务PID文件的路径(一般位于 /run/目录下)。 强烈建议在 Type=forking的情况下明确设置此选项。 如果设为相对路径，那么表示相对于 /run/目录。 systemd 将会在此服务启动完成之后，从此文件中读取主服务进程的PID 。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># WorkingDirectory=：设置进程的工作目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># User=, Group=：设置进程在执行时使用的用户与组，既可以设为一个数字形式的 UID/GID 也可以设为一个字符串形式的名称</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># BusName= 设置与此服务通信所使用的 D-Bus 名称。 在 `Type=dbus` 的情况下 必须明确设置此选项。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ExecStartPre=: 服务启动之前执行的命令</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ExecStartPost=: 服务启动之后执行的命令</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ExecStop=：服务停止时执行的命令和参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ExecStopPost=：服务停止之后执行的命令</span></span><br><span class="line"></span><br><span class="line">LimitNOFILE=infinity</span><br><span class="line">LimitNPROC=infinity</span><br><span class="line">LimitCORE=infinity</span><br><span class="line">TasksMax=infinity</span><br><span class="line">Delegate=<span class="built_in">yes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义systemd如何停止服务</span></span><br><span class="line"><span class="comment">#control-group（默认值）：当前控制组里面的所有子进程，都会被杀掉</span></span><br><span class="line"><span class="comment">#process：只杀主进程</span></span><br><span class="line"><span class="comment">#mixed：主进程将收到SIGTERM信号，子进程收到SIGKILL信号</span></span><br><span class="line"><span class="comment">#none：没有进程会被杀掉，只是执行 ExecStop= 动作, 而不杀死任何进程。 这会导致即使单元已经停止， 但是该单元的 cgroup 依然一直存在， 直到其中的进程全部死亡。</span></span><br><span class="line">KillMode=process</span><br><span class="line"></span><br><span class="line">OOMScoreAdjust=-500</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line"><span class="comment">#Alias：当前 unit 可用于启动的别名，此处列出的名称必须与服务文件名具有相同的后缀（即类型），在执行 systemctl enable 时将创建从这些名称到 unit 文件名的符号链接</span></span><br><span class="line"><span class="comment">#RequiredBy：表示该服务所在的Target，它的值是一个或多个Target，当 systemctl enable 时 unit 符号链接会放入 /etc/systemd/system 目录下面以 Target名 + .required 后缀构成的子目录中</span></span><br><span class="line"><span class="comment">#WantedBy：表示该服务所在的Target，它的值是一个或多个Target，当前 systemctl enable 时 unit符号链接会放入 /etc/systemd/system 目录下面以 Target名 + .wants 后缀构成的子目录中</span></span><br><span class="line"><span class="comment">#Also：当 systemctl enable 或 systemctl disable 时会同时 enable 和 disable 的其它 unit 列表</span></span><br><span class="line"><span class="comment">#Target的含义是服务组，表示一组服务 WantedBy=multi-user.target 指的是，unit 所在的 Target 是multi-user.target（多用户模式）</span></span><br><span class="line"><span class="comment">#这个设置非常重要，因为执行systemctl enable 是会将 unit 链接到 /etc/systemd/system/multi-user.target.wants目录之中，实现开机启动的功能</span></span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line">进程环境变量: </span><br><span class="line">* <span class="variable">$PATH</span>：可执行文件的目录列表(冒号分隔的绝对路径)， 此值固定为 `/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin`</span><br><span class="line">* <span class="variable">$LANG</span>：本地化设置。可以通过 locale.conf(5) 文件设置</span><br><span class="line">* <span class="variable">$USER</span>, <span class="variable">$LOGNAME</span>, <span class="variable">$HOME</span>, <span class="variable">$SHELL</span>：用户名, 用户名, 家目录, 登录shell</span><br><span class="line">* <span class="variable">$MAINPID</span>：单元主进程的PID (如果能确定的话)</span><br></pre></td></tr></table></figure>

<h3 id="日志管理工具-journalctl"><a href="#日志管理工具-journalctl" class="headerlink" title="日志管理工具 journalctl"></a>日志管理工具 journalctl</h3><p>[journalctl 中文手册 <a target="_blank" rel="noopener" href="https://www.jinbuguo.com/systemd/journalctl.html#">金步国] (jinbuguo.com)</a></p>
<p>1  概述</p>
<p>journalctl是ubuntu&#x2F;centos7及以上专有的日志管理工具，该工具是从message这个文件里读取信息。Systemd统一管理所有Unit的启动日志。带来的好处就是，可以只用journalctl一个命令，查看所有日志（内核日志和应用日志）。日志的配置文件是&#x2F;etc&#x2F;systemd&#x2F;journald.conf</p>
<p>2  journalctl 使用方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看所有日志, 默认情况下，只保存本次启动的日志</span></span><br><span class="line">journalctl</span><br><span class="line"><span class="comment"># 查看内核日志（不显示应用日志）</span></span><br><span class="line">journalctl -k</span><br><span class="line"><span class="comment"># 查看系统本次启动的日志</span></span><br><span class="line">journalctl   -b</span><br><span class="line">journalctl  -b  -0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看上一次启动的日志,如上次系统崩溃，需要查看日志时就要看上一次的启动日志。需更改设置:</span></span><br><span class="line"><span class="comment">#修改配置文件/etc/systemd/journald.conf, 将systemd-journald服务配置为在重新启动后永久保留系统日志，只需要将Storage参数设置为persistent。提交更改后，重新启动systemd-journald服务以使配置更改生效：</span></span><br><span class="line">vim /etc/systemd/journald.conf</span><br><span class="line">[Journal]</span><br><span class="line">Storage=persistent   <span class="comment">#修改此处</span></span><br><span class="line"><span class="comment">#重启systemd-journald服务</span></span><br><span class="line">systemctl restart systemd-journald  </span><br><span class="line"><span class="comment">#查看上一次启动的日志</span></span><br><span class="line">journalctl  -b -1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定时间的日志</span></span><br><span class="line">journalctl --since yesterday  <span class="comment">#查看昨天的日志</span></span><br><span class="line">journalctl --since <span class="string">&quot;2023-08-9 20:00:00&quot;</span> --<span class="keyword">until</span> <span class="string">&quot;2023-08-10 13:00&quot;</span>  <span class="comment">#查看8月9日到8月10日的日志</span></span><br><span class="line">journalctl --since <span class="string">&quot;12:00&quot;</span> --<span class="keyword">until</span> now  <span class="comment">#查看从12点到现在的日志</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示尾部的最新10行日志</span></span><br><span class="line">journalctl  -n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示尾部指定行数的日志. 查看的是/var/log/messages的日志，但是格式上有所调整，如主机名格式不一样而已</span></span><br><span class="line">journalctl -n 20</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实时滚动显示最新日志</span></span><br><span class="line">journalctl   -f</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看服务的日志</span></span><br><span class="line">journalctl  /usr/lib/systemd/systemd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看进程的日志</span></span><br><span class="line">journalctl   _PID=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有 D-Bus 进程产生的日志</span></span><br><span class="line">journalctl /usr/bin/dbus-daemon</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看某个路径的脚本的日志</span></span><br><span class="line">journalctl    /usr/bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定用户的日志</span></span><br><span class="line">journalctl _UID=33  --since today</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看某个Unit的日志</span></span><br><span class="line">journalctl  -u nginx.service</span><br><span class="line">journalctl  -u nginx.service  --since  today</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实时滚动显示某个Unit的最新日志</span></span><br><span class="line">journalctl  -u nginx.service  -f</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并显示多个Unit的日志</span></span><br><span class="line">journalctl  -u nginx.service  -u php-fpm.service  --since today</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看指定优先级（及其以上级别）的日志, 日志优先级共有8级</span></span><br><span class="line">0: emerg</span><br><span class="line">1: alert</span><br><span class="line">2: crit</span><br><span class="line">3: err</span><br><span class="line">4: warning</span><br><span class="line">5: notice</span><br><span class="line">6: info</span><br><span class="line">7: debug</span><br><span class="line">journalctl  -p err  -b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以JSON格式（单行）输出</span></span><br><span class="line">journalctl  -b -u httpd.service  -o json</span><br><span class="line"><span class="comment">#以JSON格式（多行）输出，可读性更好，建议选择多行输出</span></span><br><span class="line">journalctl  -b -u httpd.service  -o json-pretty</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示日志占据的硬盘空间</span></span><br><span class="line">journalctl  --disk-usage</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定日志文件占据的最大空间</span></span><br><span class="line">journalctl   --vacuum-size=1G</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定日志文件保存多久</span></span><br><span class="line">journalctl   --vacuum-time=1years</span><br></pre></td></tr></table></figure>

<h2 id="生成随机字符"><a href="#生成随机字符" class="headerlink" title="生成随机字符"></a>生成随机字符</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">openssl rand -<span class="built_in">base64</span> 8   <span class="comment"># 生成随机base64码</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$RANDOM</span>             <span class="comment"># 随机数字</span></span><br><span class="line"><span class="built_in">cat</span> /dev/urandom |<span class="built_in">tr</span> -dc <span class="string">&#x27;[:alnum:]&#x27;</span>|<span class="built_in">head</span> -c12   <span class="comment"># 提取12位的随机数字和字母</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$RANDOM</span> 12345|<span class="built_in">tr</span> -d <span class="string">&#x27; &#x27;</span>      <span class="comment">#生成后缀为12345的随机数字</span></span><br></pre></td></tr></table></figure>

<h2 id="时间同步"><a href="#时间同步" class="headerlink" title="时间同步"></a>时间同步</h2><h3 id="搭建chrony时间同步服务器-局域网同步时间）"><a href="#搭建chrony时间同步服务器-局域网同步时间）" class="headerlink" title="搭建chrony时间同步服务器(局域网同步时间）"></a>搭建chrony时间同步服务器(局域网同步时间）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 服务端</span></span><br><span class="line"><span class="comment"># apt install chrony -y</span></span><br><span class="line">yum install chrony -y</span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/chrony.conf &lt;&lt; <span class="string">EOF </span></span><br><span class="line"><span class="string">pool ntp.aliyun.com iburst</span></span><br><span class="line"><span class="string">driftfile /var/lib/chrony/drift</span></span><br><span class="line"><span class="string">makestep 1.0 3</span></span><br><span class="line"><span class="string">rtcsync</span></span><br><span class="line"><span class="string">allow 192.168.0.0/24</span></span><br><span class="line"><span class="string">local stratum 10</span></span><br><span class="line"><span class="string">keyfile /etc/chrony.keys</span></span><br><span class="line"><span class="string">leapsectz right/UTC</span></span><br><span class="line"><span class="string">logdir /var/log/chrony</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">systemctl restart chronyd ; systemctl <span class="built_in">enable</span> chronyd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 客户端</span></span><br><span class="line"><span class="comment"># apt install chrony -y</span></span><br><span class="line">yum install chrony -y</span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/chrony.conf &lt;&lt; <span class="string">EOF </span></span><br><span class="line"><span class="string">pool 192.168.0.31 iburst</span></span><br><span class="line"><span class="string">driftfile /var/lib/chrony/drift</span></span><br><span class="line"><span class="string">makestep 1.0 3</span></span><br><span class="line"><span class="string">rtcsync</span></span><br><span class="line"><span class="string">keyfile /etc/chrony.keys</span></span><br><span class="line"><span class="string">leapsectz right/UTC</span></span><br><span class="line"><span class="string">logdir /var/log/chrony</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">systemctl restart chronyd ; systemctl <span class="built_in">enable</span> chronyd</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用客户端进行验证</span></span><br><span class="line">chronyc sources -v</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数解释</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># pool ntp.aliyun.com iburst</span></span><br><span class="line"><span class="comment"># 指定使用ntp.aliyun.com作为时间服务器池，iburst选项表示在初始同步时会发送多个请求以加快同步速度。</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># driftfile /var/lib/chrony/drift</span></span><br><span class="line"><span class="comment"># 指定用于保存时钟漂移信息的文件路径。</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># makestep 1.0 3</span></span><br><span class="line"><span class="comment"># 设置当系统时间与服务器时间偏差大于1秒时，会以1秒的步长进行调整。如果偏差超过3秒，则立即进行时间调整。</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># rtcsync</span></span><br><span class="line"><span class="comment"># 启用硬件时钟同步功能，可以提高时钟的准确性。</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># allow 192.168.0.0/24</span></span><br><span class="line"><span class="comment"># 允许192.168.0.0/24网段范围内的主机与chrony进行时间同步。</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># local stratum 10</span></span><br><span class="line"><span class="comment"># 将本地时钟设为stratum 10，stratum值表示时钟的准确度，值越小表示准确度越高。</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># keyfile /etc/chrony.keys</span></span><br><span class="line"><span class="comment"># 指定使用的密钥文件路径，用于对时间同步进行身份验证。</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># leapsectz right/UTC</span></span><br><span class="line"><span class="comment"># 指定时区为UTC。</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># logdir /var/log/chrony</span></span><br><span class="line"><span class="comment"># 指定日志文件存放目录。</span></span><br></pre></td></tr></table></figure>

<h2 id="设置时间和时区"><a href="#设置时间和时区" class="headerlink" title="设置时间和时区"></a>设置时间和时区</h2><p>设置时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p>设置时区</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前时区设置</span></span><br><span class="line">timedatectl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示所有可用的时区</span></span><br><span class="line">timedatectl list-timezones</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置当前时区</span></span><br><span class="line">timedatectl set-timezone America/New_York   <span class="comment">#设置时区为美国纽约</span></span><br><span class="line">timedatectl set-timezone Asia/Shanghai      <span class="comment">#设置时区为中国上海</span></span><br><span class="line">timedatectl set-time YYYY-MM-DD             <span class="comment">#设置年,月,日</span></span><br><span class="line">timedatectl set-time HH:MM:SS               <span class="comment">#设置时间:小时,分钟,秒</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有亚洲时区 </span></span><br><span class="line"><span class="built_in">ls</span> /usr/share/zoneinfo/Asia/</span><br><span class="line"><span class="comment"># 修改时区</span></span><br><span class="line"><span class="built_in">ln</span> -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line"><span class="comment"># 更新硬件时钟</span></span><br><span class="line">hwclock -w</span><br><span class="line"><span class="comment"># 查看时区设置</span></span><br><span class="line">timedatectl status</span><br></pre></td></tr></table></figure>

<h2 id="优化内核参数"><a href="#优化内核参数" class="headerlink" title="优化内核参数"></a>优化内核参数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="LVM磁盘分区"><a href="#LVM磁盘分区" class="headerlink" title="LVM磁盘分区"></a>LVM磁盘分区</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/01/17/8abcbf98bed2ccbc.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/01/17/8abcbf98bed2ccbc.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">馒头馅儿大肉包</div><div class="post-copyright__author_desc">要努力鸭,为了想要的生活。</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://blog.techcat.cc/posts/217c81a9.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://blog.techcat.cc/posts/217c81a9.html')">Linux常用配置项</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://blog.techcat.cc/posts/217c81a9.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Linux常用配置项&amp;url=http://blog.techcat.cc/posts/217c81a9.html&amp;pic=https://s3.bmp.ovh/imgs/2023/08/27/6d630e8342072ee5.jpg?_r_=9f688367-b81a-07ea-2d65-df4159f5e4f1" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.techcat.cc" target="_blank">馒头馅儿大肉包</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/Linux/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>Linux<span class="categoryesPageCount">3</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E9%A1%B9/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>常用配置项<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E9%85%8D%E7%BD%AEIP%E5%9C%B0%E5%9D%80/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>配置IP地址<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/yum/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>yum<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/apt/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>apt<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>防火墙<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/selinux/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>selinux<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/systemd/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>systemd<span class="tagsPageCount">1</span></a></div></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/posts/ec80583f.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2023/08/27/1f9e6e52d3c3f403.jpg?_r_=0a41d438-d265-cf9f-ca05-fd3281261f6c" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Linux配置软件源</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/01/17/8abcbf98bed2ccbc.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">馒头馅儿大肉包</h1><div class="author-info__desc">要努力鸭,为了想要的生活。</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/techcatnip" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/5070155" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%9C%BA%E5%90%8D"><span class="toc-number">1.</span> <span class="toc-text">修改主机名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%B4%A6%E5%8F%B7%E5%92%8C%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">创建账号和修改密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%B4%A6%E5%8F%B7-%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.</span> <span class="toc-text">创建账号&#x2F;修改密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%BC%80%E6%9C%BA%E9%BB%98%E8%AE%A4%E7%94%A8%E6%88%B7"><span class="toc-number">2.2.</span> <span class="toc-text">配置开机默认用户</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP%E5%9C%B0%E5%9D%80"><span class="toc-number">3.</span> <span class="toc-text">配置静态IP地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Centos-7%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP%E5%9C%B0%E5%9D%80"><span class="toc-number">3.1.</span> <span class="toc-text">Centos 7配置静态IP地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ubuntu%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP%E5%9C%B0%E5%9D%80"><span class="toc-number">3.2.</span> <span class="toc-text">ubuntu配置静态IP地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Centos-8%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP%E5%9C%B0%E5%9D%80"><span class="toc-number">3.3.</span> <span class="toc-text">Centos 8配置静态IP地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nmcli%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E4%B8%80%E8%A7%88"><span class="toc-number">3.4.</span> <span class="toc-text">nmcli常用命令一览</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#yum%E3%80%81apt%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">yum、apt的基本使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#yum-dnf%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">4.1.</span> <span class="toc-text">yum&#x2F;dnf常用命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apt%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">4.2.</span> <span class="toc-text">apt常用命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="toc-number">4.3.</span> <span class="toc-text">安装常用软件包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rpm%E3%80%81dpkg%E5%8C%85%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">5.</span> <span class="toc-text">rpm、dpkg包的基本查询和使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rpm%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">5.1.</span> <span class="toc-text">rpm常用命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dpkg%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">5.2.</span> <span class="toc-text">dpkg常用命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEsshd-root%E8%BF%9C%E7%A8%8B%E7%99%BB%E9%99%86"><span class="toc-number">6.</span> <span class="toc-text">配置sshd root远程登陆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%BD%91%E5%8D%A1%E5%90%8D%E7%A7%B0%E4%B8%BAeth0"><span class="toc-number">7.</span> <span class="toc-text">修改网卡名称为eth0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%92%8C%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-number">8.</span> <span class="toc-text">查看和关闭防火墙</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%92%8C%E5%85%B3%E9%97%ADSelinux"><span class="toc-number">9.</span> <span class="toc-text">查看和关闭Selinux</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%92%8C%E5%85%B3%E9%97%ADswap%E5%88%86%E5%8C%BA"><span class="toc-number">10.</span> <span class="toc-text">查看和关闭swap分区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1systemd"><span class="toc-number">11.</span> <span class="toc-text">配置系统服务systemd</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#centos6"><span class="toc-number">11.1.</span> <span class="toc-text">centos6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#centos7-8%E3%80%81ubuntu"><span class="toc-number">11.2.</span> <span class="toc-text">centos7&#x2F;8、ubuntu</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#systemd-unit%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">11.3.</span> <span class="toc-text">systemd unit配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7-journalctl"><span class="toc-number">11.4.</span> <span class="toc-text">日志管理工具 journalctl</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E5%AD%97%E7%AC%A6"><span class="toc-number">12.</span> <span class="toc-text">生成随机字符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5"><span class="toc-number">13.</span> <span class="toc-text">时间同步</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BAchrony%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%B1%80%E5%9F%9F%E7%BD%91%E5%90%8C%E6%AD%A5%E6%97%B6%E9%97%B4%EF%BC%89"><span class="toc-number">13.1.</span> <span class="toc-text">搭建chrony时间同步服务器(局域网同步时间）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4%E5%92%8C%E6%97%B6%E5%8C%BA"><span class="toc-number">14.</span> <span class="toc-text">设置时间和时区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0"><span class="toc-number">15.</span> <span class="toc-text">优化内核参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LVM%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA"><span class="toc-number">16.</span> <span class="toc-text">LVM磁盘分区</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/217c81a9.html" title="Linux常用配置项"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2023/08/27/6d630e8342072ee5.jpg?_r_=9f688367-b81a-07ea-2d65-df4159f5e4f1" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux常用配置项"/></a><div class="content"><a class="title" href="/posts/217c81a9.html" title="Linux常用配置项">Linux常用配置项</a><time datetime="2024-01-19T10:14:54.000Z" title="发表于 2024-01-19 18:14:54">2024-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/ec80583f.html" title="Linux配置软件源"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2023/08/27/1f9e6e52d3c3f403.jpg?_r_=0a41d438-d265-cf9f-ca05-fd3281261f6c" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux配置软件源"/></a><div class="content"><a class="title" href="/posts/ec80583f.html" title="Linux配置软件源">Linux配置软件源</a><time datetime="2024-01-19T09:21:30.000Z" title="发表于 2024-01-19 17:21:30">2024-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dfa35092.html" title="kubectl备忘录"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/01/16/a41bb3528af27677.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="kubectl备忘录"/></a><div class="content"><a class="title" href="/posts/dfa35092.html" title="kubectl备忘录">kubectl备忘录</a><time datetime="2024-01-17T04:08:09.000Z" title="发表于 2024-01-17 12:08:09">2024-01-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/7c4b9639.html" title="ubuntu"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/01/16/2e7f9a9a386f638e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ubuntu"/></a><div class="content"><a class="title" href="/posts/7c4b9639.html" title="ubuntu">ubuntu</a><time datetime="2024-01-17T03:27:46.000Z" title="发表于 2024-01-17 11:27:46">2024-01-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4a17b156.html" title="Hello World"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s3.bmp.ovh/imgs/2024/01/16/bbd3745ab4915ed1.jpg?_r_=93247a4c-3a8e-e5af-1306-c0754cbc49f8" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/posts/4a17b156.html" title="Hello World">Hello World</a><time datetime="2024-01-15T09:58:22.302Z" title="发表于 2024-01-15 17:58:22">2024-01-15</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a><a class="github-badge" target="_blank" href="https://app.netlify.com/sites/techcatnip/deploys" style="margin-inline:5px" data-title="Netlify Status" title="Netlify Status"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://api.netlify.com/api/v1/badges/14025ac2-19c0-4e5b-a0db-8920be3c92eb/deploy-status" alt="Netlify Status"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2024 By <a class="footer-bar-link" href="/" title="馒头馅儿大肉包" target="_blank">馒头馅儿大肉包</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">3</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.techcat.cc/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://index.anheyu.com/" title="个人主页"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/13/64d8c2748ef34.jpg" alt="个人主页"/><span class="back-menu-item-text">个人主页</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=6681991756&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/apt/" style="font-size: 0.88rem;">apt<sup>1</sup></a><a href="/tags/centos/" style="font-size: 0.88rem;">centos<sup>1</sup></a><a href="/tags/k8s/" style="font-size: 0.88rem;">k8s<sup>1</sup></a><a href="/tags/kubectl/" style="font-size: 0.88rem;">kubectl<sup>1</sup></a><a href="/tags/kubernetes/" style="font-size: 0.88rem;">kubernetes<sup>1</sup></a><a href="/tags/selinux/" style="font-size: 0.88rem;">selinux<sup>1</sup></a><a href="/tags/systemd/" style="font-size: 0.88rem;">systemd<sup>1</sup></a><a href="/tags/ubuntu/" style="font-size: 0.88rem;">ubuntu<sup>2</sup></a><a href="/tags/yum/" style="font-size: 0.88rem;">yum<sup>1</sup></a><a href="/tags/yum%E6%BA%90/" style="font-size: 0.88rem;">yum源<sup>1</sup></a><a href="/tags/%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E9%A1%B9/" style="font-size: 0.88rem;">常用配置项<sup>1</sup></a><a href="/tags/%E7%A4%BA%E4%BE%8B/" style="font-size: 0.88rem;">示例<sup>1</sup></a><a href="/tags/%E8%BD%AF%E4%BB%B6%E6%BA%90/" style="font-size: 0.88rem;">软件源<sup>1</sup></a><a href="/tags/%E9%85%8D%E7%BD%AEIP%E5%9C%B0%E5%9D%80/" style="font-size: 0.88rem;">配置IP地址<sup>1</sup></a><a href="/tags/%E9%98%B2%E7%81%AB%E5%A2%99/" style="font-size: 0.88rem;">防火墙<sup>1</sup></a></div></div><hr/></div></div><div id="keyboard-tips"><div class="keyboardTitle">博客快捷键</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">shift K</div></div><div class="keyContent"><div class="content">关闭快捷键功能</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift A</div></div><div class="keyContent"><div class="content">打开/关闭中控台</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift M</div></div><div class="keyContent"><div class="content">播放/暂停音乐</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift D</div></div><div class="keyContent"><div class="content">深色/浅色显示模式</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift S</div></div><div class="keyContent"><div class="content">站内搜索</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift R</div></div><div class="keyContent"><div class="content">随机访问</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift H</div></div><div class="keyContent"><div class="content">返回首页</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift F</div></div><div class="keyContent"><div class="content">友链鱼塘</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift L</div></div><div class="keyContent"><div class="content">友链页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift P</div></div><div class="keyContent"><div class="content">关于本站</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift I</div></div><div class="keyContent"><div class="content">原版/本站右键菜单</div></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="7815766992" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/7815766992&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 馒头馅儿大肉包 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("04/01/2021 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.cbd.int/mathjax@3.2.2/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.cbd.int/katex@0.16.0/dist/katex.min.css"><script src="https://cdn.cbd.int/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    anzhiyu.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://leafy-dasik-1bfebc.netlify.app/.netlify/functions/twikoo',
      region: 'ap-east-1',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://leafy-dasik-1bfebc.netlify.app/.netlify/functions/twikoo',
      region: 'ap-east-1',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://leafy-dasik-1bfebc.netlify.app/.netlify/functions/twikoo',
        region: 'ap-east-1',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/bangumis/"]):not([href="/album/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>